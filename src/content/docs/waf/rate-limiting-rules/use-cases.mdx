---
title: Rule examples
pcx_content_type: configuration
sidebar:
  order: 20
head:
  - tag: title
    content: Rate limiting rule examples
---

import { Example } from "~/components";

The examples below include sample rate limiting rule configurations.

## Example 1

The following [rate limiting rule](/waf/rate-limiting-rules/create-zone-dashboard/) performs rate limiting on incoming requests from the US addressed at the login page, except for one allowed IP address.

<Example>

Expression:<br />
`(http.request.uri.path eq "/login" and ip.src.country eq "US" and ip.src ne 192.0.0.1)`

Rule characteristics:

- _Data center ID_ (included by default when creating the rule in the dashboard)
- _IP Address_

</Example>

## Example 2

The following [rate limiting rule](/waf/rate-limiting-rules/create-zone-dashboard/) performs rate limiting on incoming requests with a given base URI path, incrementing on the IP address and the provided API key.

<Example>

Expression:<br />
`(http.request.uri.path contains "/product" and http.request.method eq "POST")`

Rule characteristics:

- _Data center ID_ (included by default when creating the rule in the dashboard)
- _IP Address_
- _Header value of_ > `x-api-key`

</Example>

## Example 3

The following [rate limiting rule](/waf/rate-limiting-rules/create-zone-dashboard/) performs rate limiting on requests targeting multiple URI paths in two hosts, excluding known bots. The request rate is based on IP address and `User-Agent` values.

<Example>

Expression:<br />
`(http.request.uri.path eq "/store" or http.request.uri.path eq "/prices") and (http.host eq "mystore1.com" or http.host eq "mystore2.com") and not cf.client.bot`

Rule characteristics:

- _Data center ID_ (included by default when creating the rule in the dashboard)
- _IP Address_
- _Header value of_ > `user-agent`

</Example>

## Example 4

:::note
[Complexity-based rate limiting](/waf/rate-limiting-rules/request-rate/#complexity-based-rate-limiting) is only available to Enterprise customers with Advanced Rate Limiting.
:::

The following [rate limiting rule](/waf/rate-limiting-rules/create-zone-dashboard/) performs complexity-based rate limiting. The rule takes into account the `my-score` HTTP response header provided by the origin server to calculate a total complexity score for the client with the provided API key.

The counter with the total score is updated when there is a match for the rate limiting rule's [counting expression](/waf/rate-limiting-rules/parameters/#increment-counter-when) (in this case, the same as the rule expression since a counting expression was not provided). When this total score becomes larger than `400` during a period of one minute, any later client requests will be blocked for a period of 10 minutes.

 <Example>

Expression:<br />
`(http.request.uri.path wildcard "/graphql/*")`

Rule characteristics:

- _Data center ID_ (included by default when creating the rule in the dashboard)
- _Header value of_ > `x-api-key`

When rate exceeds: **Complexity based**

- Score per period: `400`
- Period: _1 minute_
- Response header name: `my-score`

Then take action:

- Choose action: _Block_

With the following behavior: **Block for the selected duration**

- Duration: _10 minutes_

</Example>

For an API example with this rule configuration, refer to [Create a rate limiting rule via API](/waf/rate-limiting-rules/create-api/#example-d---complexity-based-rate-limiting-rule).
